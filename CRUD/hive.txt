-- Create Database
CREATE DATABASE IF NOT EXISTS library_db;
USE library_db;

-- Create Table
CREATE TABLE IF NOT EXISTS books (
    id INT,
    title STRING,
    author STRING,
    year INT,
    genre STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE;

-- Insert Records
INSERT INTO TABLE books VALUES 
    (1, '1984', 'George Orwell', 1949, 'Dystopian'),
    (2, 'To Kill a Mockingbird', 'Harper Lee', 1960, 'Fiction'),
    (3, 'The Great Gatsby', 'F. Scott Fitzgerald', 1925, 'Classic'),
    (4, 'Programming in C', 'K. KEERTHIVAASAN', 2024, 'Educational'),
    (5, 'Naruto', 'S. ASHISH', 2022, 'Comics');

-- Select All Records
SELECT * FROM books;

-- Update Records
INSERT OVERWRITE TABLE books
SELECT 
    id,
    title,
    author,
    CASE
        WHEN id = 1 THEN 1955
        ELSE year
    END AS year,
    genre
FROM books;

-- Delete Records
INSERT OVERWRITE TABLE books
SELECT * FROM books WHERE id != 2;
